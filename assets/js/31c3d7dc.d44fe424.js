"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8591],{336:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var n=t(5893),i=t(1151);const o={title:"Bloop \u26a1\ufe0f",sidebar_position:10},a=void 0,r={id:"commands/misc/bloop",title:"Bloop \u26a1\ufe0f",description:"Scala CLI by default uses Bloop as a build server for compiling code. This approach has its advantages over the scalac compiler such as advanced caching and fast compile times, but the process is more complex.",source:"@site/docs/commands/misc/bloop.md",sourceDirName:"commands/misc",slug:"/commands/misc/bloop",permalink:"/docs/commands/misc/bloop",draft:!1,unlisted:!1,editUrl:"https://github.com/Virtuslab/scala-cli/edit/main/website/docs/commands/misc/bloop.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{title:"Bloop \u26a1\ufe0f",sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Publish Local \u26a1\ufe0f",permalink:"/docs/commands/publishing/publish-local"},next:{title:"Default File \u26a1\ufe0f",permalink:"/docs/commands/misc/default-file"}},c={},l=[{value:"Starting the server",id:"starting-the-server",level:3},{value:"Communicating with the server",id:"communicating-with-the-server",level:3},{value:"Killing the server",id:"killing-the-server",level:3}];function h(e){const s={a:"a",admonition:"admonition",code:"code",h3:"h3",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.p,{children:["Scala CLI by default uses Bloop as a build server for compiling code. This approach has its advantages over the ",(0,n.jsx)(s.code,{children:"scalac"})," compiler such as advanced caching and fast compile times, but the process is more complex.\nFortunately for the users, Scala CLI fully manages the Bloop build server. This includes its whole lifecycle, which starts with fetching the artifacts.\nThis document showcases the ",(0,n.jsx)(s.code,{children:"bloop"})," subcommand that allows you manually manage the Bloop server.\nIt also goes through the server's lifecycle and the interactions that Scala CLI has with it."]}),"\n",(0,n.jsxs)(s.admonition,{type:"caution",children:[(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"bloop"})," sub-command is restricted and requires setting the ",(0,n.jsx)(s.code,{children:"--power"})," option to be used.\nYou can pass it explicitly or set it globally by running:"]}),(0,n.jsx)(s.p,{children:"scala-cli config power true"})]}),"\n",(0,n.jsx)(s.h3,{id:"starting-the-server",children:"Starting the server"}),"\n",(0,n.jsx)(s.p,{children:"Whenever the code is compiled using Bloop, the first step is checking if the server is online, as it is launched as a daemon thread there's a chance it may have been launched during a past compilation.\nHowever, if the server is offline then Scala CLI needs to start and configure it."}),"\n",(0,n.jsxs)(s.p,{children:["The configuration file for Bloop is created after analyzing the options collected from command line flags and using directives.\nThe default location of the file is ",(0,n.jsx)(s.code,{children:".scala-build/bloop/project_name.json"}),"."]}),"\n",(0,n.jsx)(s.p,{children:"The last thing before launching the server is downloading its artifacts from Maven Central via Coursier if they are not already present in the local cache."}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsxs)(s.p,{children:["When working in an environment with restricted access to the web, using Bloop can be disabled with the ",(0,n.jsx)(s.code,{children:"--server=false"})," flag. Also, see the ",(0,n.jsx)(s.a,{href:"/docs/guides/offline",children:"section about the Offline mode"}),"."]})}),"\n",(0,n.jsxs)(s.p,{children:["Bloop is started as a separate JVM process, parameters of this process can be configured using arguments passed to the invoked subcommand (",(0,n.jsx)(s.a,{href:"/docs/reference/cli-options#compilation-server-options",children:"see compilation server options"}),").\nThey also depend on the JVM version chosen for building the project, it cannot be higher than the version of the JVM running Bloop. If such a case is detected, the build server has to be restarted with a sufficiently high JVM.\nNote that the default version of the JVM for Bloop is 17, so if your ",(0,n.jsx)(s.code,{children:"JAVA_HOME"})," refers to an older version of Java, Scala CLI will fetch the one you need. You can also override the JVM version Bloop runs on with the ",(0,n.jsx)(s.code,{children:"--bloop-jvm"})," option.\nTo start the Bloop server manually you can use the ",(0,n.jsx)(s.code,{children:"bloop start"})," subcommand:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"scala-cli --power bloop start\n"})}),"\n",(0,n.jsx)(s.h3,{id:"communicating-with-the-server",children:"Communicating with the server"}),"\n",(0,n.jsx)(s.p,{children:"During the communication process, Scala CLI acts mostly as an intermediary between Bloop and the build client.\nThe build client can be either the user invoking the tool from the command line or the IDE seeing Scala CLI as a build server.\nThe behavior is mostly the same in both cases and is based on forwarding the messages. The messages being forwarded need to sometimes be edited as a result of preprocessing Scala CLI does, e.g. generating script sources."}),"\n",(0,n.jsx)(s.p,{children:"The main difference between running on the command line and serving an IDE is the information that gets through to the client.\nWhile an IDE receives all the messages that Bloop sends, the user only receives the relevant information, like warnings and errors coming from the compilation process."}),"\n",(0,n.jsx)(s.h3,{id:"killing-the-server",children:"Killing the server"}),"\n",(0,n.jsx)(s.p,{children:"In general, the Bloop server is started as a daemon process that sticks around even after Scala CLI exits.\nThe server can sometimes be automatically killed and restarted if a configuration change requires that, e.g. JVM version requested by the build is too high."}),"\n",(0,n.jsxs)(s.p,{children:["However, sometimes it is needed to restart the Bloop server manually, for that the ",(0,n.jsx)(s.code,{children:"bloop exit"})," subcommand can be used:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"scala-cli --power bloop exit\n"})})]})}function d(e={}){const{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},1151:(e,s,t)=>{t.d(s,{Z:()=>r,a:()=>a});var n=t(7294);const i={},o=n.createContext(i);function a(e){const s=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(o.Provider,{value:s},e.children)}}}]);